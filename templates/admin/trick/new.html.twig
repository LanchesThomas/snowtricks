{% extends 'base.html.twig' %}

{% set action = app.current_route == 'app_admin_trick_new' ? 'Ajout' : 'Édition' %}
{% block title %}{{ action }} d'un trick{% endblock %}

{% block body %}
    <style>
        .form-wrapper {
            display: flex;
            flex-direction: column;
            gap: 56px;
            padding-top: 32px;
        }
    </style>


    
    
    <div class="container-standard">
    <div class="form-wrapper">
    
        <h1 class="heading-1">{{ action }} d'un trick</h1>
        
        {{ form_start(form) }}
            {{form_row(form.name, {
                label: 'Nom du trick'
            })}}
            {{form_row(form.description, {
                label: 'Description du trick'
            })}}
            {{form_row(form.groupname, {
                label: 'Groupe du trick'
            })}}
            <h3>Médias</h3>
            <div id="media-collection" data-prototype="{{ form_widget(form.media.vars.prototype)|e('html_attr') }}">
                {% for media in form.media %}
                    <div class="media-item">
                        {{ form_row(media.url, {'label': 'Fichier média'}) }}
                    </div>
                {% endfor %}
            </div>
            <button type="button" id="add-media-btn" class="btn btn-secondary">Ajouter un média</button>

        <button type="submit" class="btn btn-primary">Envoyer</button>
        {{ form_end(form) }}
    </div>
    </div>

        <script>
    document.getElementById('add-media-btn').addEventListener('click', function() {
    const collectionHolder = document.getElementById('media-collection');
    const prototype = collectionHolder.dataset.prototype;
    const newIndex = collectionHolder.children.length;

    const newForm = prototype.replace(/__name__/g, newIndex);
    const newFormElement = document.createElement('div');
    newFormElement.innerHTML = newForm;
    collectionHolder.appendChild(newFormElement);
});

    </script>
{% endblock %}